<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title></title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width">

        <!-- Place favicon.ico and apple-touch-icon.png in the root directory -->

        <link rel="stylesheet" href="css/normalize.css">
        <link rel="stylesheet" href="css/main.css">
        <style>

body {
  font: 10px sans-serif;
}

.chord path {
  fill-opacity: .67;
  stroke: #000;
  stroke-width: .5px;
}

</style>

        <script src="js/vendor/modernizr-2.6.2.min.js"></script>
    </head>
    <body>
        <!--[if lt IE 7]>
            <p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p>
        <![endif]-->

        <!-- Add your site or application content here -->
        <p>Hello world! This is HTML5 Boilerplate.</p>

        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
        <script>window.jQuery || document.write('<script src="js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
        <script src="js/plugins.js"></script>
<script src="http://d3js.org/d3.v3.min.js"></script>
<script>

// From http://mkweb.bcgsc.ca/circos/guide/tables/
var data = {
  "stations": [{
    "name": "South Station",
    "latLng": [42.352175,-71.055547],
    "depts": "26555",
    "destinations": [{
      "name": "TD Garden",
      "latLng": [42.3662,-71.0608],
      "trips": "2690"
    }, {
      "name": "Lewis Wharf - Atlantic Ave",
      "latLng": [42.363871,-71.050877],
      "trips": "2312"
    }, {
      "name": "Rowes Wharf - Atlantic Ave.",
      "latLng":[42.357143,-71.050699],
      "trips": "1629"
    }, {
      "name": "Aquarium Station - 200 Atlantic Ave.",
      "latLng": [42.35977,-71.051601],
      "trips": "1413"
    }, {
      "name": "Cross St. at Hanover St. ",
      "latLng": [42.362811,-71.056067],
      "trips": "1306"
    }, {
      "name": "Boylston St. at Arlington St. ",
      "latLng": [42.352096,-71.070378],
      "trips": "1171"
    }, {
      "name": "Boylston St.  / Berkeley St. ",
      "latLng": [42.350989,-71.073644],
      "trips": "1009"
    }, 
    // {
    //   "name": "South Station - 700 Atlantic Ave",
    //   "latLng": [42.352175,-71.055547],
    //   "trips": "1008"
    // }, 
    {
      "name": "Seaport Hotel",
      "latLng": [42.348833,-71.041747],
      "trips": "869"
    }, {
      "name": "Boston Public Library - 700 Boylston St. ",
      "latLng": [42.349673,-71.077303],
      "trips": "746"
    }]
  }, {
    "name": "TD Garden - Legends Way",
    "latLng": [42.366231,-71.060868],
    "depts": "21343",
    "destinations": [{
      "name": "South Station - 700 Atlantic Ave.",//done
      "latLng": [42.352175, -71.055547],
      "trips": "2473"
    }, {
      "name": "Rowes Wharf - Atlantic Ave.",//done
      "latLng":[42.357143,-71.050699],
      "trips": "1367"
    }, {
      "name": "Congress/Sleeper",//done
      "latLng": [42.3511,-71.0496],
      "trips": "1150"
    }, {
      "name": "Post Office Square",

      "latLng": [42.352175, -71.055547],
      "trips": "1119"
    }, {
      "name": "TD Garden - Legends Way",//done
      "latLng": [42.366231,-71.060868],
      "trips": "1064"
    }, {
      "name": "Seaport Square - Seaport Blvd. at Boston Wharf",//done
      "latLng": [42.351821,-71.045461],
      "trips": "995"
    }, {
      "name": "Boylston St. at Arlington St. ",

      "latLng": [42.352175, -71.055547],
      "trips": "830"
    }, {
      "name": "Aquarium Station - 200 Atlantic Ave.",

      "latLng": [42.352175, -71.055547],
      "trips": "798"
    }, {
      "name": "Summer St. / Arch St. ",

      "latLng": [42.352175, -71.055547],
      "trips": "704"
    }, {
      "name": "Faneuil Hall - Union St. at North St. ",

      "latLng": [42.352175, -71.055547],
      "trips": "691"
    }]
  }, {
    "name": "Boston Public Library - 700 Boylston St.",
    "depts": "21334",
    "destinations": [{
      "name": "Boston Public Library - 700 Boylston St. ",

      "latLng": [42.352175, -71.055547],
      "trips": "1937"
    }, {
      "name": "South Station - 700 Atlantic Ave.",

      "latLng": [42.352175, -71.055547],
      "trips": "989"
    }, {
      "name": "Boylston St. at Arlington St. ",

      "latLng": [42.352175, -71.055547],
      "trips": "814"
    }, {
      "name": "Charles Circle - Charles St. at Cambridge St. ",

      "latLng": [42.352175, -71.055547],
      "trips": "749"
    }, {
      "name": "Tremont St. / West St.",

      "latLng": [42.352175, -71.055547],
      "trips": "617"
    }, {
      "name": "Newbury St. / Hereford St. ",

      "latLng": [42.352175, -71.055547],
      "trips": "579"
    }, {
      "name": "Stuart St. at Charles St. ",

      "latLng": [42.352175, -71.055547],
      "trips": "556"
    }, {
      "name": "Beacon St. / Mass Ave",

      "latLng": [42.352175, -71.055547],
      "trips": "541"
    }, {
      "name": "Fanueil Hall - Union St. at North St. ",

      "latLng": [42.352175, -71.055547],
      "trips": "539"
    }, {
      "name": "The Esplanade - Beacon St. at Arlington St. ",

      "latLng": [42.352175, -71.055547],
      "trips": "535"
    }]
  }, {
    "name": "Boylston St. at Arlington St.",
    "depts": "16366",
    "destinations": [{
      "name": "Boylston St. at Arlington St. ",

      "latLng": [42.352175, -71.055547],
      "trips": "1568"
    }, {
      "name": "South Station - 700 Atlantic Ave.",

      "latLng": [42.352175, -71.055547],
      "trips": "1273"
    }, {
      "name": "TD Garden - Legends Way",

      "latLng": [42.366231,-71.060868],
      "trips": "706"
    }, {
      "name": "Newbury St. / Hereford St. ",

      "latLng": [42.352175, -71.055547],
      "trips": "694"
    }, {
      "name": "Boston Public Library - 700 Boylston St. ",

      "latLng": [42.352175, -71.055547],
      "trips": "618"
    }, {
      "name": "Rowes Wharf - Atlantic Ave.",

      "latLng": [42.352175, -71.055547],
      "trips": "567"
    }, {
      "name": "Kenmore Sq. /Comm Ave",

      "latLng": [42.352175, -71.055547],
      "trips": "526"
    }, {
      "name": "Charles Circle - Charles St. at Cambridge St. ",

      "latLng": [42.352175, -71.055547],
      "trips": "482"
    }, {
      "name": "Tremont St. / West St. ",

      "latLng": [42.352175, -71.055547],
      "trips": "453"
    }, {
      "name": "Mayor Thomas M. Menino  - Government Center",

      "latLng": [42.352175, -71.055547],
      "trips": "432"
    }]
  }, {
    "name": "Back Bay / South End Station",
    "depts": "14456",
    "destinations": [{
      "name": "Washington St. at Rutland St. Boston, Ma",

      "latLng": [42.352175, -71.055547],
      "trips": "1253"
    }, {
      "name": "Tremont St / W Newton St. ",

      "latLng": [42.352175, -71.055547],
      "trips": "794"
    }, {
      "name": "Back Bay / South End Station",

      "latLng": [42.352175, -71.055547],
      "trips": "700"
    }, {
      "name": "Roxbury Crossing Station",

      "latLng": [42.352175, -71.055547],
      "trips": "663"
    }, {
      "name": "Columbus Ave. at Mass Ave.",

      "latLng": [42.352175, -71.055547],
      "trips": "659"
    }, {
      "name": "Christian Science Plaza",

      "latLng": [42.352175, -71.055547],
      "trips": "594"
    }, {
      "name": "Washington St. at Waltham St. ",

      "latLng": [42.352175, -71.055547],
      "trips": "479"
    }, {
      "name": "Prudential Center / Belvidere",

      "latLng": [42.352175, -71.055547],
      "trips": "429"
    }, {
      "name": "Boston Medical Center - 721 Mass. Ave",

      "latLng": [42.352175, -71.055547],
      "trips": "399"
    }, {
      "name": "Stuart St. at Charles St. ",

      "latLng": [42.352175, -71.055547],
      "trips": "394"
    }]
  }, {
    "name": "Charles Circle - Charles St. at Cambridge St.",
    "depts": "13616",
    "destinations": [{
      "name": "Charles Circle - Charles St. at Cambridge St.",

      "latLng": [42.352175, -71.055547],
      "trips": "1479"
    }, {
      "name": "Boston Public Library - 700 Boylston St.",

      "latLng": [42.352175, -71.055547],
      "trips": "869"
    }, {
      "name": "Beacon St / Mass Ave",

      "latLng": [42.352175, -71.055547],
      "trips": "770"
    }, {
      "name": "TD Garden - Legends Way",

      "latLng": [42.366231,-71.060868],
      "trips": "551"
    }, {
      "name": "Boylston St. at Arlington St. ",

      "latLng": [42.352175, -71.055547],
      "trips": "549"
    }, {
      "name": "The Esplanade - Beacon St. at Arlington St. ",

      "latLng": [42.352175, -71.055547],
      "trips": "462"
    }, {
      "name": "Kenmore Sq / Comm Ave",

      "latLng": [42.352175, -71.055547],
      "trips": "446"
    }, {
      "name": "Stuart St. at Charles St.",

      "latLng": [42.352175, -71.055547],
      "trips": "418"
    }, {
      "name": "Cross St. at Hanover St. ",

      "latLng": [42.352175, -71.055547],
      "trips": "409"
    }, {
      "name": "Mayor Thomas M. Menino - Government Center",

      "latLng": [42.352175, -71.055547],
      "trips": "326"
    }]
  }, {
    "name": "Kenmore Square / Comm Ave. Total Departures:",
    "depts": "13108",
    "destinations": [

    {
      "name": "Agganis Arena - 925 Comm. Ave.",

      "latLng": [42.352175, -71.055547],
      "trips": "1066"
    }, {
      "name": "Kenmore Sq / Comm Ave",

      "latLng": [42.352175, -71.055547],
      "trips": "956"
    }, {
      "name": "B.U. Central - 725 Comm Ave",

      "latLng": [42.352175, -71.055547],
      "trips": "951"
    }, {
      "name": "Packard's Corner - Comm. Ave at Brighton Ave. ",

      "latLng": [42.352175, -71.055547],
      "trips": "829"
    }, {
      "name": "Boston Public Library - 700 Boylston St. ",

      "latLng": [42.352175, -71.055547],
      "trips": "503"
    }, {
      "name": "Boylston St. at Arlington St. ",

      "latLng": [42.352175, -71.055547],
      "trips": "469"
    }, {
      "name": "Landmark Centre",

      "latLng": [42.352175, -71.055547],
      "trips": "452"
    }, {
      "name": "Charles Circle - Charles St. at Cambridge St.",

      "latLng": [42.352175, -71.055547],
      "trips": "417"
    }, {
      "name": "Newbury St / Hereford St.",

      "latLng": [42.352175, -71.055547],
      "trips": "389"
    }, {
      "name": "The Esplanade - Beacon St. at Arlington St.",

      "latLng": [42.352175, -71.055547],
      "trips": "385"
    }]
  }, {
    "name": "Beacon St. / Mass Ave.",
    "depts": "12589",
    "destinations": [{
      "name": "Beacon St. / Mass. Ave",

      "latLng": [42.352175, -71.055547],
      "trips": "1322"
    }, {
      "name": "Charles Circle - Charles St. at Cambridge St.",

      "latLng": [42.352175, -71.055547],
      "trips": "660"
    }, {
      "name": "Boston Public Library - 700 Boylston St.",

      "latLng": [42.352175, -71.055547],
      "trips": "618"
    }, {
      "name": "Kenmore Sq. / Comm Ave",

      "latLng": [42.352175, -71.055547],
      "trips": "545"
    }, {
      "name": "Boylston St. at Arlington St.",

      "latLng": [42.352175, -71.055547],
      "trips": "455"
    }, {
      "name": "MIT at Mass Ave / Amherst St.",

      "latLng": [42.352175, -71.055547],
      "trips": "446"
    }, {
      "name": "The Esplanade - Beacon St. at Arlington St.",

      "latLng": [42.352175, -71.055547],
      "trips": "384"
    }, {
      "name": "TD Garden - Legends Way",

      "latLng": [42.366231,-71.060868],
      "trips": "333"
    }, {
      "name": "Christian Science Plaza",

      "latLng": [42.352175, -71.055547],
      "trips": "324"
    }, {
      "name": "Boylston / Mass Ave",

      "latLng": [42.352175, -71.055547],
      "trips": "308"
    }]
  }, {
    "name": "Lewis Wharf - Atlantic Ave.",
    "depts": "12288",
    "destinations": [{
      "name": "South Station - 700 Atlantic Ave.",

      "latLng": [42.352175, -71.055547],
      "trips": "2369"
    }, {
      "name": "Rowes Wharf - Atlantic Ave",

      "latLng": [42.352175, -71.055547],
      "trips": "895"
    }, {
      "name": "Lewis Wharf - Atlantic Ave.",

      "latLng": [42.352175, -71.055547],
      "trips": "876"
    }, {
      "name": "TD Garden - Legends Way",

      "latLng": [42.366231,-71.060868],
      "trips": "656"
    }, {
      "name": "Post Office Square",

      "latLng": [42.352175, -71.055547],
      "trips": "524"
    }, {
      "name": "Congress / Sleeper",

      "latLng": [42.352175, -71.055547],
      "trips": "473"
    }, {
      "name": "Seaport Square - Seaport Blvd. at Boston Wharf",//done
      "latLng": [42.351821,-71.045461],
      "trips": "464"
    }, {
      "name": "Fanueil Hall - Union St. at North St. ",

      "latLng": [42.352175, -71.055547],
      "trips": "448"
    }, {
      "name": "Aquarium Station - 200 Atlantic Ave.",

      "latLng": [42.352175, -71.055547],
      "trips": "431"
    }, {
      "name": "Chinatown Gate Plaza - Surface Rd. at Beach St. ",

      "latLng": [42.352175, -71.055547],
      "trips": "413"
    }]
  }, {
    "name": "Newbury St. / Hereford St.",
    "depts": "12262",
    "destinations": [{
      "name": "Newbury St. / Hereford St. ",

      "latLng": [42.352175, -71.055547],
      "trips": "1159"
    }, {
      "name": "Boylston St. at Arlington St.",

      "latLng": [42.352175, -71.055547],
      "trips": "626"
    }, {
      "name": "Boston Public Library - 700 Boylston St. ",

      "latLng": [42.352175, -71.055547],
      "trips": "549"
    }, {
      "name": "Washington St. at Rutland St. Boston, Ma",

      "latLng": [42.352175, -71.055547],
      "trips": "465"
    }, {
      "name": "Kenmore Sq / Comm Ave.",

      "latLng": [42.352175, -71.055547],
      "trips": "437"
    }, {
      "name": "Yawkey Way at Boylston St. ",

      "latLng": [42.352175, -71.055547],
      "trips": "397"
    }, {
      "name": "Packard's Corner - Comm Ave. at Brighton Ave.",

      "latLng": [42.352175, -71.055547],
      "trips": "361"
    }, {
      "name": "Charles Circle - Charles St. at Cambridge St.",

      "latLng": [42.352175, -71.055547],
      "trips": "322"
    }, {
      "name": "Landmark Centre",

      "latLng": [42.352175, -71.055547],
      "trips": "307"
    }, {
      "name": "Stuart St. at Charles St. ",

      "latLng": [42.352175, -71.055547],
      "trips": "299"
    }]
  }]
}

var chord = d3.layout.chord()
    .padding(.05)
    .sortSubgroups(d3.descending)
    .matrix(matrix);

var width = 960,
    height = 500,
    innerRadius = Math.min(width, height) * .41,
    outerRadius = innerRadius * 1.1;

var fill = d3.scale.ordinal()
    .domain(d3.range(4))
    .range(["#000000", "#FFDD89", "#957244", "#F26223"]);

var svg = d3.select("body").append("svg")
    .attr("width", width)
    .attr("height", height)
  .append("g")
    .attr("transform", "translate(" + width / 2 + "," + height / 2 + ")");

svg.append("g").selectAll("path")
    .data(chord.groups)
  .enter().append("path")
    .style("fill", function(d) { return fill(d.index); })
    .style("stroke", function(d) { return fill(d.index); })
    .attr("d", d3.svg.arc().innerRadius(innerRadius).outerRadius(outerRadius))
    .on("mouseover", fade(.1))
    .on("mouseout", fade(1));

var ticks = svg.append("g").selectAll("g")
    .data(chord.groups)
  .enter().append("g").selectAll("g")
    .data(groupTicks)
  .enter().append("g")
    .attr("transform", function(d) {
      return "rotate(" + (d.angle * 180 / Math.PI - 90) + ")"
          + "translate(" + outerRadius + ",0)";
    });

ticks.append("line")
    .attr("x1", 1)
    .attr("y1", 0)
    .attr("x2", 5)
    .attr("y2", 0)
    .style("stroke", "#000");

ticks.append("text")
    .attr("x", 8)
    .attr("dy", ".35em")
    .attr("transform", function(d) { return d.angle > Math.PI ? "rotate(180)translate(-16)" : null; })
    .style("text-anchor", function(d) { return d.angle > Math.PI ? "end" : null; })
    .text(function(d) { return d.label; });

svg.append("g")
    .attr("class", "chord")
  .selectAll("path")
    .data(chord.chords)
  .enter().append("path")
    .attr("d", d3.svg.chord().radius(innerRadius))
    .style("fill", function(d) { return fill(d.target.index); })
    .style("opacity", 1);

// Returns an array of tick angles and labels, given a group.
function groupTicks(d) {
  var k = (d.endAngle - d.startAngle) / d.value;
  return d3.range(0, d.value, 1000).map(function(v, i) {
    return {
      angle: v * k + d.startAngle,
      label: i % 5 ? null : v / 1000 + "k"
    };
  });
}

// Returns an event handler for fading a given chord group.
function fade(opacity) {
  return function(g, i) {
    svg.selectAll(".chord path")
        .filter(function(d) { return d.source.index != i && d.target.index != i; })
      .transition()
        .style("opacity", opacity);
  };
}
</script>

        <!-- Google Analytics: change UA-XXXXX-X to be your site's ID. -->
        <script>
            var _gaq=[['_setAccount','UA-XXXXX-X'],['_trackPageview']];
            (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
            g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
            s.parentNode.insertBefore(g,s)}(document,'script'));
        </script>
    </body>
</html>
